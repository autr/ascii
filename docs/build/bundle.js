var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function r(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function l(e){let t;return c(e,(e=>t=e))(),t}function s(e,t,n){e.$$.on_destroy.push(c(t,n))}function a(e,t,n,o){return e[1]&&o?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](o(t))):n.ctx}function u(e,t,n){return e.set(n),t}function f(e,t){e.appendChild(t)}function d(e,t,n){e.insertBefore(t,n||null)}function p(e){e.parentNode.removeChild(e)}function m(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function h(e){return document.createElement(e)}function g(e){return document.createTextNode(e)}function y(){return g(" ")}function v(){return g("")}function x(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function E(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function A(e){return""===e?null:+e}function w(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function T(e,t){e.value=null==t?"":t}function b(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function C(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}e.selectedIndex=-1}function I(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function V(e,t,n){e.classList[n?"add":"remove"](t)}let $;function k(e){$=e}function O(e){(function(){if(!$)throw new Error("Function called outside component initialization");return $})().$$.on_mount.push(e)}const S=[],D=[],K=[],M=[],L=Promise.resolve();let z=!1;function H(e){K.push(e)}let N=!1;const B=new Set;function F(){if(!N){N=!0;do{for(let e=0;e<S.length;e+=1){const t=S[e];k(t),_(t.$$)}for(k(null),S.length=0;D.length;)D.pop()();for(let e=0;e<K.length;e+=1){const t=K[e];B.has(t)||(B.add(t),t())}K.length=0}while(S.length);for(;M.length;)M.pop()();z=!1,N=!1,B.clear()}}function _(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(H)}}const P=new Set;function j(e,t){e&&e.i&&(P.delete(e),e.i(t))}function Z(e,t,n,o){if(e&&e.o){if(P.has(e))return;P.add(e),undefined.c.push((()=>{P.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}const R="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function q(e){e&&e.c()}function G(e,n,i,c){const{fragment:l,on_mount:s,on_destroy:a,after_update:u}=e.$$;l&&l.m(n,i),c||H((()=>{const n=s.map(t).filter(r);a?a.push(...n):o(n),e.$$.on_mount=[]})),u.forEach(H)}function Y(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function U(e,t){-1===e.$$.dirty[0]&&(S.push(e),z||(z=!0,L.then(F)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function X(t,r,i,c,l,s,a,u=[-1]){const f=$;k(t);const d=t.$$={fragment:null,ctx:null,props:s,update:e,not_equal:l,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(f?f.$$.context:[])),callbacks:n(),dirty:u,skip_bound:!1,root:r.target||f.$$.root};a&&a(d.root);let m=!1;if(d.ctx=i?i(t,r.props||{},((e,n,...o)=>{const r=o.length?o[0]:n;return d.ctx&&l(d.ctx[e],d.ctx[e]=r)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](r),m&&U(t,e)),n})):[],d.update(),m=!0,o(d.before_update),d.fragment=!!c&&c(d.ctx),r.target){if(r.hydrate){const e=function(e){return Array.from(e.childNodes)}(r.target);d.fragment&&d.fragment.l(e),e.forEach(p)}else d.fragment&&d.fragment.c();r.intro&&j(t.$$.fragment),G(t,r.target,r.anchor,r.customElement),F()}k(f)}class J{$destroy(){Y(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var W=te,Q=te,ee=function(e,t,n){e.removeEventListener("wheel",t,n)};function te(e,t,n){e.addEventListener("wheel",t,n)}W.addWheelListener=Q,W.removeWheelListener=ee;var ne=.1,oe="function"==typeof Float32Array;function re(e,t){return 1-3*t+3*e}function ie(e,t){return 3*t-6*e}function ce(e){return 3*e}function le(e,t,n){return((re(t,n)*e+ie(t,n))*e+ce(t))*e}function se(e,t,n){return 3*re(t,n)*e*e+2*ie(t,n)*e+ce(t)}function ae(e){return e}var ue=function(e,t,n,o){if(!(0<=e&&e<=1&&0<=n&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&n===o)return ae;for(var r=oe?new Float32Array(11):new Array(11),i=0;i<11;++i)r[i]=le(i*ne,e,n);function c(t){for(var o=0,i=1;10!==i&&r[i]<=t;++i)o+=ne;--i;var c=o+(t-r[i])/(r[i+1]-r[i])*ne,l=se(c,e,n);return l>=.001?function(e,t,n,o){for(var r=0;r<4;++r){var i=se(t,n,o);if(0===i)return t;t-=(le(t,n,o)-e)/i}return t}(t,c,e,n):0===l?c:function(e,t,n,o,r){var i,c,l=0;do{(i=le(c=t+(n-t)/2,o,r)-e)>0?n=c:t=c}while(Math.abs(i)>1e-7&&++l<10);return c}(t,o,o+ne,e,n)}return function(e){return 0===e?0:1===e?1:le(c(e),t,o)}},fe={ease:ue(.25,.1,.25,1),easeIn:ue(.42,0,1,1),easeOut:ue(0,0,.58,1),easeInOut:ue(.42,0,.58,1),linear:ue(0,0,1,1)},de=function(e,t,n){var o=Object.create(null),r=Object.create(null),i="function"==typeof(n=n||{}).easing?n.easing:fe[n.easing];i||(n.easing&&console.warn("Unknown easing function in amator: "+n.easing),i=fe.ease);var c="function"==typeof n.step?n.step:he,l="function"==typeof n.done?n.done:he,s=function(e){if(!e){return"undefined"!=typeof window&&window.requestAnimationFrame?{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}:{next:function(e){return setTimeout(e,1e3/60)},cancel:function(e){return clearTimeout(e)}}}if("function"!=typeof e.next)throw new Error("Scheduler is supposed to have next(cb) function");if("function"!=typeof e.cancel)throw new Error("Scheduler is supposed to have cancel(handle) function");return e}(n.scheduler),a=Object.keys(t);a.forEach((function(n){o[n]=e[n],r[n]=t[n]-e[n]}));var u,f="number"==typeof n.duration?n.duration:400,d=Math.max(1,.06*f),p=0;return u=s.next((function t(){var n=i(p/d);p+=1,m(n),p<=d?(u=s.next(t),c(e)):(u=0,setTimeout((function(){l(e)}),0))})),{cancel:function(){s.cancel(u),u=0}};function m(t){a.forEach((function(n){e[n]=r[n]*t+o[n]}))}},pe=ge,me=ge();function he(){}function ge(){var e=new Set,t=new Set,n=0;return{next:o,cancel:o,clearAll:function(){e.clear(),t.clear(),cancelAnimationFrame(n),n=0}};function o(e){t.add(e),n||(n=requestAnimationFrame(r))}function r(){n=0;var o=t;t=e,(e=o).forEach((function(e){e()})),e.clear()}}de.makeAggregateRaf=pe,de.sharedScheduler=me;var ye=function(e){!function(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var t=["on","fire","off"],n=0;n<t.length;++n)if(e.hasOwnProperty(t[n]))throw new Error("Subject cannot be eventified, since it already has property '"+t[n]+"'")}(e);var t=function(e){var t=Object.create(null);return{on:function(n,o,r){if("function"!=typeof o)throw new Error("callback is expected to be a function");var i=t[n];return i||(i=t[n]=[]),i.push({callback:o,ctx:r}),e},off:function(n,o){if(void 0===n)return t=Object.create(null),e;if(t[n])if("function"!=typeof o)delete t[n];else for(var r=t[n],i=0;i<r.length;++i)r[i].callback===o&&r.splice(i,1);return e},fire:function(n){var o,r=t[n];if(!r)return e;arguments.length>1&&(o=Array.prototype.splice.call(arguments,1));for(var i=0;i<r.length;++i){var c=r[i];c.callback.apply(c.ctx,o)}return e}}}(e);return e.on=t.on,e.off=t.off,e.fire=t.fire,e};var ve=function(e,t,n){"object"!=typeof n&&(n={});var o,r,i,c,l,s,a,u,f,d,p="number"==typeof n.minVelocity?n.minVelocity:5,m="number"==typeof n.amplitude?n.amplitude:.25,h="function"==typeof n.cancelAnimationFrame?n.cancelAnimationFrame:xe(),g="function"==typeof n.requestAnimationFrame?n.requestAnimationFrame:Ee();return{start:function(){o=e(),s=f=c=a=0,r=new Date,h(i),h(d),i=g(y)},stop:function(){h(i),h(d);var t=e();l=t.x,u=t.y,r=Date.now(),(c<-p||c>p)&&(l+=s=m*c);(a<-p||a>p)&&(u+=f=m*a);d=g(v)},cancel:function(){h(i),h(d)}};function y(){var t=Date.now(),n=t-r;r=t;var l=e(),s=l.x-o.x,u=l.y-o.y;o=l;var f=1e3/(1+n);c=.8*s*f+.2*c,a=.8*u*f+.2*a,i=g(y)}function v(){var e=Date.now()-r,n=!1,o=0,i=0;s&&((o=-s*Math.exp(-e/342))>.5||o<-.5?n=!0:o=s=0),f&&((i=-f*Math.exp(-e/342))>.5||i<-.5?n=!0:i=f=0),n&&(t(l+o,u+i),d=g(v))}};function xe(){return"function"==typeof cancelAnimationFrame?cancelAnimationFrame:clearTimeout}function Ee(){return"function"==typeof requestAnimationFrame?requestAnimationFrame:function(e){return setTimeout(e,16)}}var Ae=function(e){if(e)return{capture:Te,release:Te};var t,n,o,r=!1;return{capture:function(e){r=!0,n=window.document.onselectstart,o=window.document.ondragstart,window.document.onselectstart=we,(t=e).ondragstart=we},release:function(){if(!r)return;r=!1,window.document.onselectstart=n,t&&(t.ondragstart=o)}}};function we(e){return e.stopPropagation(),!1}function Te(){}var be=function(){this.x=0,this.y=0,this.scale=1};var Ce=function(e,t){if(!Ve(e))throw new Error("svg element is required for svg.panzoom to work");var n=e.ownerSVGElement;if(!n)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");t.disableKeyboardInteraction||n.setAttribute("tabindex",0);return{getBBox:function(){var t=e.getBBox();return{left:t.x,top:t.y,width:t.width,height:t.height}},getScreenCTM:function(){var e=n.getCTM();if(!e)return n.getScreenCTM();return e},getOwner:function(){return n},applyTransform:function(t){e.setAttribute("transform","matrix("+t.scale+" 0 0 "+t.scale+" "+t.x+" "+t.y+")")},initTransform:function(t){var o=e.getCTM();null===o&&(o=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix());t.x=o.e,t.y=o.f,t.scale=o.a,n.removeAttributeNS(null,"viewBox")}}},Ie=Ve;function Ve(e){return e&&e.ownerSVGElement&&e.getCTM}Ce.canAttach=Ie;var $e=function(e,t){if(!Oe(e))throw new Error("panzoom requires DOM element to be attached to the DOM tree");var n=e.parentElement;e.scrollTop=0,t.disableKeyboardInteraction||n.setAttribute("tabindex",0);return{getBBox:function(){return{left:0,top:0,width:e.clientWidth,height:e.clientHeight}},getOwner:function(){return n},applyTransform:function(t){e.style.transformOrigin="0 0 0",e.style.transform="matrix("+t.scale+", 0, 0, "+t.scale+", "+t.x+", "+t.y+")"}}},ke=Oe;function Oe(e){return e&&e.parentElement&&e.style}$e.canAttach=ke;var Se=Ae(),De=Ae(!0),Ke=Me;function Me(e,t){var n=(t=t||{}).controller;if(n||(Ce.canAttach(e)?n=Ce(e,t):$e.canAttach(e)&&(n=$e(e,t))),!n)throw new Error("Cannot create panzoom for the current type of dom element");var o=n.getOwner(),r={x:0,y:0},i=!1,c=new be;n.initTransform&&n.initTransform(c);var l,s="function"==typeof t.filterKey?t.filterKey:He,a="number"==typeof t.pinchSpeed?t.pinchSpeed:1,u=t.bounds,f="number"==typeof t.maxZoom?t.maxZoom:Number.POSITIVE_INFINITY,d="number"==typeof t.minZoom?t.minZoom:0,p="number"==typeof t.boundsPadding?t.boundsPadding:.05,m="number"==typeof t.zoomDoubleClickSpeed?t.zoomDoubleClickSpeed:1.75,h=t.beforeWheel||He,g=t.beforeMouseDown||He,y="number"==typeof t.zoomSpeed?t.zoomSpeed:1,v=Le(t.transformOrigin),x=t.enableTextSelection?De:Se;!function(e){var t=typeof e;if("undefined"===t||"boolean"===t)return;if(!(Ne(e.left)&&Ne(e.top)&&Ne(e.bottom)&&Ne(e.right)))throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}(u),t.autocenter&&function(){var e,t,r=0,i=0,l=F();if(l)r=l.left,i=l.top,e=l.right-l.left,t=l.bottom-l.top;else{var s=o.getBoundingClientRect();e=s.width,t=s.height}var a=n.getBBox();if(0===a.width||0===a.height)return;var u=t/a.height,f=e/a.width,d=Math.min(f,u);c.x=-(a.left+a.width/2)*d+e/2+r,c.y=-(a.top+a.height/2)*d+t/2+i,c.scale=d}();var E,A,w,T,b,C,I,V,$=0,k=!1,O=!1;b="smoothScroll"in t&&!t.smoothScroll?{start:He,stop:He,cancel:He}:ve((function(){return{x:c.x,y:c.y}}),(function(e,t){pe(),H(e,t)}),t.smoothScroll);var S=!1;R();var D={dispose:function(){q()},moveBy:Z,moveTo:H,smoothMoveTo:function(e,t){Z(e-c.x,t-c.y,!0)},centerOn:function(e){var t=e.ownerSVGElement;if(!t)throw new Error("ui element is required to be within the scene");var n=e.getBoundingClientRect(),o=n.left+n.width/2,r=n.top+n.height/2,i=t.getBoundingClientRect(),c=i.width/2-o,l=i.height/2-r;Z(c,l,!0)},zoomTo:fe,zoomAbs:j,smoothZoom:ae,smoothZoomAbs:function(e,t,n){var o={scale:c.scale},r={scale:n};b.cancel(),pe(),I=de(o,r,{step:function(n){j(e,t,n.scale)}})},showRectangle:function(e){var t=o.getBoundingClientRect(),n=z(t.width,t.height),r=e.right-e.left,i=e.bottom-e.top;if(!Number.isFinite(r)||!Number.isFinite(i))throw new Error("Invalid rectangle");var l=n.x/r,s=n.y/i,a=Math.min(l,s);c.x=-(e.left+r/2)*a+n.x/2,c.y=-(e.top+i/2)*a+n.y/2,c.scale=a},pause:function(){q(),S=!0},resume:function(){S&&(R(),S=!1)},isPaused:function(){return S},getTransform:function(){return c},getMinZoom:function(){return d},setMinZoom:function(e){d=e},getMaxZoom:function(){return f},setMaxZoom:function(e){f=e},getTransformOrigin:function(){return v},setTransformOrigin:function(e){v=Le(e)},getZoomSpeed:function(){return y},setZoomSpeed:function(e){if(!Number.isFinite(e))throw new Error("Zoom speed should be a number");y=e}};ye(D);var K="number"==typeof t.initialX?t.initialX:c.x,M="number"==typeof t.initialY?t.initialY:c.y,L="number"==typeof t.initialZoom?t.initialZoom:c.scale;return K==c.x&&M==c.y&&L==c.scale||j(K,M,L),D;function z(e,t){if(n.getScreenCTM){var o=n.getScreenCTM(),i=o.a,c=o.d,l=o.e,s=o.f;r.x=e*i-l,r.y=t*c-s}else r.x=e,r.y=t;return r}function H(e,t){c.x=e,c.y=t,B(),Ee("pan"),_()}function N(e,t){H(c.x+e,c.y+t)}function B(){var e=F();if(e){var t,o,r,i,l=!1,s=(t=n.getBBox(),r=t.left,i=t.top,{left:(o={x:r*c.scale+c.x,y:i*c.scale+c.y}).x,top:o.y,right:t.width*c.scale+o.x,bottom:t.height*c.scale+o.y}),a=e.left-s.right;return a>0&&(c.x+=a,l=!0),(a=e.right-s.left)<0&&(c.x+=a,l=!0),(a=e.top-s.bottom)>0&&(c.y+=a,l=!0),(a=e.bottom-s.top)<0&&(c.y+=a,l=!0),l}}function F(){if(u){if("boolean"==typeof u){var e=o.getBoundingClientRect(),t=e.width,n=e.height;return{left:t*p,top:n*p,right:t*(1-p),bottom:n*(1-p)}}return u}}function _(){i=!0,l=window.requestAnimationFrame(G)}function P(e,t,n){if(Be(e)||Be(t)||Be(n))throw new Error("zoom requires valid numbers");var o=c.scale*n;if(o<d){if(c.scale===d)return;n=d/c.scale}if(o>f){if(c.scale===f)return;n=f/c.scale}var r=z(e,t);(c.x=r.x-n*(r.x-c.x),c.y=r.y-n*(r.y-c.y),u&&1===p&&1===d)?(c.scale*=n,B()):B()||(c.scale*=n);Ee("zoom"),_()}function j(e,t,n){P(e,t,n/c.scale)}function Z(e,t,n){if(!n)return N(e,t);C&&C.cancel();var o=0,r=0;C=de({x:0,y:0},{x:e,y:t},{step:function(e){N(e.x-o,e.y-r),o=e.x,r=e.y}})}function R(){o.addEventListener("mousedown",ne,{passive:!1}),o.addEventListener("dblclick",te,{passive:!1}),o.addEventListener("touchstart",U,{passive:!1}),o.addEventListener("keydown",Y,{passive:!1}),W.addWheelListener(o,le,{passive:!1}),_()}function q(){W.removeWheelListener(o,le),o.removeEventListener("mousedown",ne),o.removeEventListener("keydown",Y),o.removeEventListener("dblclick",te),o.removeEventListener("touchstart",U),l&&(window.cancelAnimationFrame(l),l=0),b.cancel(),ie(),ce(),x.release(),ge()}function G(){i&&(i=!1,n.applyTransform(c),Ee("transform"),l=0)}function Y(e){var t=0,n=0,r=0;if(38===e.keyCode?n=1:40===e.keyCode?n=-1:37===e.keyCode?t=1:39===e.keyCode?t=-1:189===e.keyCode||109===e.keyCode?r=1:187!==e.keyCode&&107!==e.keyCode||(r=-1),!s(e,t,n,r)){if(t||n){e.preventDefault(),e.stopPropagation();var i=o.getBoundingClientRect();Z(.05*(c=Math.min(i.width,i.height))*t,.05*c*n)}if(r){var c,l=me(100*r);fe((c=v?ue():{x:(a=o.getBoundingClientRect()).width/2,y:a.height/2}).x,c.y,l)}var a}}function U(e){if(function(e){if(t.onTouch&&!t.onTouch(e))return;e.stopPropagation(),e.preventDefault()}(e),1===e.touches.length)return function(e){var t=se(e.touches[0]);E=t;var n=z(t.x,t.y);A=n.x,w=n.y,b.cancel(),X()}(e,e.touches[0]);2===e.touches.length&&(T=ee(e.touches[0],e.touches[1]),V=!0,X())}function X(){k||(k=!0,document.addEventListener("touchmove",J),document.addEventListener("touchend",Q),document.addEventListener("touchcancel",Q))}function J(e){if(1===e.touches.length){e.stopPropagation();var t=z((f=se(e.touches[0])).x,f.y),n=t.x-A,o=t.y-w;0!==n&&0!==o&&he(),A=t.x,w=t.y,Z(n,o)}else if(2===e.touches.length){V=!0;var r=e.touches[0],i=e.touches[1],c=ee(r,i),l=1+(c/T-1)*a,s=se(r),u=se(i);if(A=(s.x+u.x)/2,w=(s.y+u.y)/2,v){var f=ue();A=f.x,w=f.y}fe(A,w,l),T=c,e.stopPropagation(),e.preventDefault()}}function Q(e){if(e.touches.length>0){var t=z((n=se(e.touches[0])).x,n.y);A=t.x,w=t.y}else{var n,o=new Date;if(o-$<300)if(v)ae((n=ue()).x,n.y,m);else ae(E.x,E.y,m);$=o,ge(),ce()}}function ee(e,t){var n=e.clientX-t.clientX,o=e.clientY-t.clientY;return Math.sqrt(n*n+o*o)}function te(e){!function(e){t.onDoubleClick&&!t.onDoubleClick(e)||(e.preventDefault(),e.stopPropagation())}(e);var n=se(e);v&&(n=ue()),ae(n.x,n.y,m)}function ne(e){if(!g(e)){if(k)return e.stopPropagation(),!1;if(1===e.button&&null!==window.event||0===e.button){b.cancel();var t=se(e),n=z(t.x,t.y);return A=n.x,w=n.y,document.addEventListener("mousemove",oe),document.addEventListener("mouseup",re),x.capture(e.target||e.srcElement),!1}}}function oe(e){if(!k){he();var t=se(e),n=z(t.x,t.y),o=n.x-A,r=n.y-w;A=n.x,w=n.y,Z(o,r)}}function re(){x.release(),ge(),ie()}function ie(){document.removeEventListener("mousemove",oe),document.removeEventListener("mouseup",re),O=!1}function ce(){document.removeEventListener("touchmove",J),document.removeEventListener("touchend",Q),document.removeEventListener("touchcancel",Q),O=!1,V=!1,k=!1}function le(e){if(!h(e)){b.cancel();var t=e.deltaY;e.deltaMode>0&&(t*=100);var n=me(t);if(1!==n){var o=v?ue():se(e);fe(o.x,o.y,n),e.preventDefault()}}}function se(e){var t=o.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}function ae(e,t,n){var o=c.scale,r={scale:o},i={scale:n*o};b.cancel(),pe(),I=de(r,i,{step:function(n){j(e,t,n.scale)},done:xe})}function ue(){var e=o.getBoundingClientRect();return{x:e.width*v.x,y:e.height*v.y}}function fe(e,t,n){return b.cancel(),pe(),P(e,t,n)}function pe(){I&&(I.cancel(),I=null)}function me(e){return 1-Math.sign(e)*Math.min(.25,Math.abs(y*e/128))}function he(){O||(Ee("panstart"),O=!0,b.start())}function ge(){O&&(V||b.stop(),Ee("panend"))}function xe(){Ee("zoomend")}function Ee(e){D.fire(e,D)}}function Le(e){if(e)return"object"==typeof e?(Ne(e.x)&&Ne(e.y)||ze(e),e):void ze()}function ze(e){throw console.error(e),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join("\n"))}function He(){}function Ne(e){return Number.isFinite(e)}function Be(e){return Number.isNaN?Number.isNaN(e):e!=e}!function(){if("undefined"!=typeof document){var e=document.getElementsByTagName("script");if(e){for(var t,n=0;n<e.length;++n){var o=e[n];if(o.src&&o.src.match(/\bpanzoom(\.min)?\.js/)){t=o;break}}if(t){var r=t.getAttribute("query");if(r){var i=t.getAttribute("name")||"pz",c=Date.now();!function e(){var n=document.querySelector(r);if(!n){return Date.now()-c<2e3?void setTimeout(e,100):void console.error("Cannot find the panzoom element",i)}var o=function(e){for(var t=e.attributes,n={},o=0;o<t.length;++o){var r=l(t[o]);r&&(n[r.name]=r.value)}return n}(t);console.log(o),window[i]=Me(n,o)}()}}}}function l(e){if(e.name&&("p"===e.name[0]&&"z"===e.name[1]&&"-"===e.name[2]))return{name:e.name.substr(3),value:JSON.parse(e.value)}}}();const{window:Fe}=R;function _e(e){let t,n,r,i,c,l,s,u,m,v,A,T,C;const I=e[14].default,$=function(e,t,n,o){if(e){const r=a(e,t,n,o);return e[0](r)}}(I,e,e[13],null);return{c(){t=h("div"),n=h("header"),r=h("div"),i=g(e[5]),c=y(),l=h("div"),s=h("div"),u=y(),m=h("div"),v=h("div"),$&&$.c(),E(r,"class","grow p0-5 minh2em"),E(s,"class","minw1em border clickable"),V(s,"dash",e[4]),E(l,"class","pointer p0-5 flex"),E(n,"class","flex row bb pop border"),E(v,"class","bg flex column bl br bb"),E(m,"class","flex column"),V(m,"invisible",e[4]),b(t,"transform","translate("+e[7]+"px, "+e[6]+"px)"),E(t,"class","flex column abs"),V(t,"t0",e[0]),V(t,"l0",e[1]),V(t,"r0",e[2]),V(t,"b0",e[3])},m(o,a){d(o,t,a),f(t,n),f(n,r),f(r,i),f(n,c),f(n,l),f(l,s),f(t,u),f(t,m),f(m,v),$&&$.m(v,null),A=!0,T||(C=[x(Fe,"mouseup",e[9]),x(Fe,"mousemove",e[8]),x(s,"click",e[15]),x(t,"mousedown",e[10])],T=!0)},p(e,[n]){(!A||32&n)&&w(i,e[5]),16&n&&V(s,"dash",e[4]),$&&$.p&&(!A||8192&n)&&function(e,t,n,o,r,i){if(r){const c=a(t,n,o,i);e.p(c,r)}}($,I,e,e[13],A?function(e,t,n,o){if(e[2]&&o){const r=e[2](o(n));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],n=Math.max(t.dirty.length,r.length);for(let o=0;o<n;o+=1)e[o]=t.dirty[o]|r[o];return e}return t.dirty|r}return t.dirty}(I,e[13],n,null):function(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}(e[13]),null),16&n&&V(m,"invisible",e[4]),(!A||192&n)&&b(t,"transform","translate("+e[7]+"px, "+e[6]+"px)"),1&n&&V(t,"t0",e[0]),2&n&&V(t,"l0",e[1]),4&n&&V(t,"r0",e[2]),8&n&&V(t,"b0",e[3])},i(e){A||(j($,e),A=!0)},o(e){Z($,e),A=!1},d(e){e&&p(t),$&&$.d(e),T=!1,o(C)}}}function Pe(e,t,n){let o,r,i,{$$slots:c={},$$scope:l}=t,{title:s=""}=t,{top:a=null}=t,{left:u=null}=t,{right:f=null}=t,{bottom:d=null}=t,{minimised:p=!1}=t;const m=e=>console.log(`[Panel] ${e}`),h=window;let g=!1,y=null,v=null;O((async e=>{if(""!=s)try{const e=JSON.parse(h.localStorage.getItem(i));n(0,a=e.top),n(1,u=e.left),n(2,f=e.right),n(3,d=e.bottom),n(4,p=e.minimised),m(`💠 loaded ${i} positions`)}catch(e){}}));let x=null;return e.$$set=e=>{"title"in e&&n(5,s=e.title),"top"in e&&n(0,a=e.top),"left"in e&&n(1,u=e.left),"right"in e&&n(2,f=e.right),"bottom"in e&&n(3,d=e.bottom),"minimised"in e&&n(4,p=e.minimised),"$$scope"in e&&n(13,l=e.$$scope)},e.$$.update=()=>{6&e.$$.dirty&&n(7,o=u||-1*f),9&e.$$.dirty&&n(6,r=a||-1*d),32&e.$$.dirty&&n(12,i=`Panel_${s.replaceAll(" ","_")}`),6175&e.$$.dirty&&(x&&clearTimeout(x),n(11,x=setTimeout((e=>{m("💠 stored"),h.localStorage.setItem(i,JSON.stringify({top:a,left:u,right:f,bottom:d,minimised:p}))}),400)))},[a,u,f,d,p,s,r,o,function(e){if(g){const{clientX:t,clientY:o}=e;null!=u&&n(1,u=v.left-(y.clientX-t)),null!=f&&n(2,f=v.right+(y.clientX-t)),null!=a&&n(0,a=v.top-(y.clientY-o)),null!=d&&n(3,d=v.bottom+(y.clientY-o))}},function(e){h.zoomer&&h.zoomer.resume(),g=!1},function(e){if(h.zoomer&&h.zoomer.pause(),-1!=["textarea","number","text"].indexOf(e.target.type))return;g=!0;const{clientX:t,clientY:n}=e;y={clientX:t,clientY:n},v={top:a,left:u,right:f,bottom:d}},x,i,l,c,e=>n(4,p=!p)]}class je extends J{constructor(e){super(),X(this,e,Pe,_e,i,{title:5,top:0,left:1,right:2,bottom:3,minimised:4})}}const Ze="rectangle",Re="pointer",qe="select",Ge="char",Ye="&nbsp;",Ue="start",Xe="center",Je="end",We="justify",Qe=["textarea","number","text"],et={[Re]:{},[qe]:{},[Ge]:{},[Ze]:{}},tt=["Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash"],nt={tl:["╭","┌","┍","┎","┏","╭","╔","╒","╓"],tr:["╮","┐","┑","┒","┓","╮","╗","╕","╖"],bl:["╰","└","┕","┖","┗","╰","╚","╘","╙"],br:["╯","┘","┙","┚","┛","╯","╝","╛","╜"]},ot={v:["│","┃","┆","┇","┊","┋","╎","╏","╽","╿","╵","╷","╹","╻"],h:["─","━","┄","┅","┈","┉","╌","╍","╼","╾","╴","╶","╸","╺"]},rt=["▀","▁","▂","▃","▄","▅","▆","▇","█","▉","▊","▋","▌","▍","▎","▏","▐","░","▒","▓","▔","▕","▖","▗","▘","▙","▚","▛","▜","▝","▞","▟"],it=["KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash"],ct=["Q","W","E","R","T","Y","U","I","O","P","[","]","A","S","D","F","G","H","J","K","L",";","'","\\","Z","X","C","V","B","N","M",",",".","/"],lt=[[...ct],[...rt],[...ot.h,...ot.v,"╲","╱","╳"],[...nt.tl,...nt.tr,...nt.bl,...nt.br],["⃝","⃠","↺","↻","⇴","⌼","⌽","⌾","⍉","⍜","⍟","⍥","⎋","⏀","⏁","⏂","⏣","○","◌","◍","●","◐","◑","◒","◓","◔","◕","◖","◗","◙","◚","◛","◠","◡","◯","◴","◵","◶","◷","⚆","⚇","⚈","⚉","⚬","❍","⟟","⟲","⟳","⥀","⥁","⥈","⥉","⦲","⦵","⦺","⦻","⦽","⧂","⧃","⧇","⧬","⧭","⧲","⧳","⨢","⨭","⨮","⨴","⨵","⨷","⩹","⩺","⫯","⫰","⫱","⬤","⬰","￮","𐩑","𐩒","𑗘","𑗙","𑗚","𛲅","𛲕"]],st=["Default","Blocks","Lines","Corners","Circles"],at=window,ut=e=>console.log(`[Chars] ${e}`);function ft(){if(!at.ACTIVE||at?.ACTIVE?.type!=Ze)return;let{start:e,end:t}=at.ACTIVE;ut("🟦 set");for(let n=0;n<height;n++)for(let o=0;o<width;o++){at.ACTIVE.chars[n]||(at.ACTIVE.chars[n]=[]);const r=n==e.y||n==t.y,i=o==e.x||o==t.x,c=o>=e.x&&o<=t.x,l=n>=e.y&&n<=t.y,s=n==e.y&&o==e.x,a=n==e.y&&o==t.x,u=n==t.y&&o==t.x,f=n==t.y&&o==e.x;let d=!0;const p=rt[at.ACTIVE.fill];s?at.ACTIVE.chars[n][o]=nt.tl[at.ACTIVE.corner]||p:a?at.ACTIVE.chars[n][o]=nt.tr[at.ACTIVE.corner]||p:u?at.ACTIVE.chars[n][o]=nt.br[at.ACTIVE.corner]||p:f?at.ACTIVE.chars[n][o]=nt.bl[at.ACTIVE.corner]||p:r&&c?at.ACTIVE.chars[n][o]=ot.h[at.ACTIVE.sides]||p:i&&l?at.ACTIVE.chars[n][o]=ot.v[at.ACTIVE.sides]||p:c&&l&&"number"==typeof at.ACTIVE.fill?at.ACTIVE.chars[n][o]=p:(at.ACTIVE.chars[n][o]=null,d=!1),d&&(at.HIGH[n]||(at.HIGH[n]=[]),at.HIGH[n][o]=!0)}}function dt(){if(!at.ACTIVE)return;if(at?.ACTIVE?.type!=Ze)return;ut("🔠 set");let{start:e,end:t,padding:n,whitespace:o}={start:{...at.ACTIVE.start},end:{...at.ACTIVE.end},padding:at.ACTIVE.padding,whitespace:at.ACTIVE.whitespace};const r=at.ACTIVE.corner>=0&&null!=at.ACTIVE.corner,i=at.ACTIVE.sides>=0&&null!=at.ACTIVE.sides;(r||i)&&(e.x+=1+n,e.y+=1+n,t.x-=1+n,t.y-=1+n);const c=at.ACTIVE?.alignX||Xe,l=at.ACTIVE?.alignY||Xe;console.log(`[App] setting textbox with x "${c}" and y "${l}"`);const s=t.x-e.x,a=t.y-e.y;at.ACTIVE.text=at.ACTIVE.text||"",at.ACTIVE.lines=[];let u="";for(const e of at.ACTIVE.text.split("\n")){for(const t of e.split(" "))if(u.length+t.length+1<s){u+=(""!=u?" ":"")+t}else at.ACTIVE.lines.push(u),u=t;at.ACTIVE.lines.push(u),u=""}const{lines:f}=at.ACTIVE,d=a-at.ACTIVE.lines.length,p=l==Xe&&a>f.length,m=c==Xe,h=l==Je&&a>f.length,g=c==Je;for(let n=e.y;n<=t.y;n++)for(let r=e.x;r<=t.x;r++){at.ACTIVE.chars[n]||(at.ACTIVE.chars[n]=[]);let t=n-e.y,i=r-e.x;p&&(t-=d/2+.5),h&&(t-=d+1),t=Math.round(t);const c=f?.[t],l=s-c?.length;m&&c&&(i-=Math.round(l/2)),g&&c&&(i-=Math.round(l)+1),i=Math.round(i);const a=c?.[i];a&&(at.ACTIVE.chars[n][r]=a),!a&&o&&(at.ACTIVE.chars[n][r]=Ye),at.HIGH[n]||(at.HIGH[n]=[]),at.HIGH[n][r]=!0}}const pt=[];function mt(t,n=e){let o;const r=new Set;function c(e){if(i(t,e)&&(t=e,o)){const e=!pt.length;for(const e of r)e[1](),pt.push(e,t);if(e){for(let e=0;e<pt.length;e+=2)pt[e][0](pt[e+1]);pt.length=0}}}return{set:c,update:function(e){c(e(t))},subscribe:function(i,l=e){const s=[i,l];return r.add(s),1===r.size&&(o=n(c)||e),i(t),()=>{r.delete(s),0===r.size&&(o(),o=null)}}}}const ht=mt({}),gt=mt(0),yt=mt(!1),vt=mt(null),xt=mt(Ze);function Et(){}function At(e,t,n,o,r){for(var i=0,c=t.length,l=0,s=0;i<c;i++){var a=t[i];if(a.removed){if(a.value=e.join(o.slice(s,s+a.count)),s+=a.count,i&&t[i-1].added){var u=t[i-1];t[i-1]=t[i],t[i]=u}}else{if(!a.added&&r){var f=n.slice(l,l+a.count);f=f.map((function(e,t){var n=o[s+t];return n.length>e.length?n:e})),a.value=e.join(f)}else a.value=e.join(n.slice(l,l+a.count));l+=a.count,a.added||(s+=a.count)}}var d=t[c-1];return c>1&&"string"==typeof d.value&&(d.added||d.removed)&&e.equals("",d.value)&&(t[c-2].value+=d.value,t.pop()),t}function wt(e){return{newPos:e.newPos,components:e.components.slice(0)}}Et.prototype={diff:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.callback;"function"==typeof n&&(o=n,n={}),this.options=n;var r=this;function i(e){return o?(setTimeout((function(){o(void 0,e)}),0),!0):e}e=this.castInput(e),t=this.castInput(t),e=this.removeEmpty(this.tokenize(e));var c=(t=this.removeEmpty(this.tokenize(t))).length,l=e.length,s=1,a=c+l,u=[{newPos:-1,components:[]}],f=this.extractCommon(u[0],t,e,0);if(u[0].newPos+1>=c&&f+1>=l)return i([{value:this.join(t),count:t.length}]);function d(){for(var n=-1*s;n<=s;n+=2){var o=void 0,a=u[n-1],f=u[n+1],d=(f?f.newPos:0)-n;a&&(u[n-1]=void 0);var p=a&&a.newPos+1<c,m=f&&0<=d&&d<l;if(p||m){if(!p||m&&a.newPos<f.newPos?(o=wt(f),r.pushComponent(o.components,void 0,!0)):((o=a).newPos++,r.pushComponent(o.components,!0,void 0)),d=r.extractCommon(o,t,e,n),o.newPos+1>=c&&d+1>=l)return i(At(r,o.components,t,e,r.useLongestToken));u[n]=o}else u[n]=void 0}s++}if(o)!function e(){setTimeout((function(){if(s>a)return o();d()||e()}),0)}();else for(;s<=a;){var p=d();if(p)return p}},pushComponent:function(e,t,n){var o=e[e.length-1];o&&o.added===t&&o.removed===n?e[e.length-1]={count:o.count+1,added:t,removed:n}:e.push({count:1,added:t,removed:n})},extractCommon:function(e,t,n,o){for(var r=t.length,i=n.length,c=e.newPos,l=c-o,s=0;c+1<r&&l+1<i&&this.equals(t[c+1],n[l+1]);)c++,l++,s++;return s&&e.components.push({count:s}),e.newPos=c,l},equals:function(e,t){return this.options.comparator?this.options.comparator(e,t):e===t||this.options.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};var Tt=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,bt=/\S/,Ct=new Et;Ct.equals=function(e,t){return this.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||this.options.ignoreWhitespace&&!bt.test(e)&&!bt.test(t)},Ct.tokenize=function(e){for(var t=e.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),n=0;n<t.length-1;n++)!t[n+1]&&t[n+2]&&Tt.test(t[n])&&Tt.test(t[n+2])&&(t[n]+=t[n+2],t.splice(n+1,2),n--);return t};var It=new Et;function Vt(e){return Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vt(e)}It.tokenize=function(e){var t=[],n=e.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var o=0;o<n.length;o++){var r=n[o];o%2&&!this.options.newlineIsToken?t[t.length-1]+=r:(this.options.ignoreWhitespace&&(r=r.trim()),t.push(r))}return t},(new Et).tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)},(new Et).tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};var $t=Object.prototype.toString,kt=new Et;function Ot(e,t,n,o,r){var i,c;for(t=t||[],n=n||[],o&&(e=o(r,e)),i=0;i<t.length;i+=1)if(t[i]===e)return n[i];if("[object Array]"===$t.call(e)){for(t.push(e),c=new Array(e.length),n.push(c),i=0;i<e.length;i+=1)c[i]=Ot(e[i],t,n,o,r);return t.pop(),n.pop(),c}if(e&&e.toJSON&&(e=e.toJSON()),"object"===Vt(e)&&null!==e){t.push(e),c={},n.push(c);var l,s=[];for(l in e)e.hasOwnProperty(l)&&s.push(l);for(s.sort(),i=0;i<s.length;i+=1)c[l=s[i]]=Ot(e[l],t,n,o,l);t.pop(),n.pop()}else c=e;return c}kt.useLongestToken=!0,kt.tokenize=It.tokenize,kt.castInput=function(e){var t=this.options,n=t.undefinedReplacement,o=t.stringifyReplacer,r=void 0===o?function(e,t){return void 0===t?n:t}:o;return"string"==typeof e?e:JSON.stringify(Ot(e,null,null,r),r,"  ")},kt.equals=function(e,t){return Et.prototype.equals.call(kt,e.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"))};var St=new Et;St.tokenize=function(e){return e.slice()},St.join=St.removeEmpty=function(e){return e},navigator?.keyboard?.getLayoutMap&&navigator.keyboard.getLayoutMap().then((e=>{Dt.keyboardLayoutMap=e;const t=document.getElementById("capture");console.log(t),t.addEventListener("keydown",(e=>{})),t.dispatchEvent(new Event("focus")),t.dispatchEvent(new KeyboardEvent("keydown",{code:"KeyQ"})),console.log("[Keys] keyboardLayoutMap",Object.keys(e),Object.values(e))}));const Dt=window,Kt=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"],Mt=e=>{const t=l(gt),n=lt[t],o=n[it.indexOf(e.code)];return{keys:l(ht),keyboardIdx:t,board:n,char:o,mode:l(xt),modes:Object.keys(et),activeElement:l(vt),number:(e?.keyCode||0)-49}};let Lt=!1;const zt=e=>console.log(`[Keys] ${e}`);async function Ht(e){if(zt(`👇👇 textbox keydown ${e.target.value.length} chars`),e.key.length>1||e.metaKey||e.ctrlKey)return;const{target:t}=e,{value:n,selectionStart:o,selectionEnd:r}=t,{char:i}=Mt(e);e.target.value=Dt.ACTIVE.text=`${n.substring(0,o)}${i||e.key}${n.substring(r)}`,e.target.setSelectionRange(o+1,o+1),e.preventDefault()}async function Nt(e){zt(`👆👆 textbox keyup ${e.target.value.length} chars`)}async function Bt(e){zt(`👆 ${e.code}`);let{mode:t,modes:n,keys:o,keyboardIdx:r,activeElement:i,number:c,board:l,char:s}=Mt(e);-1!=Qe.indexOf(i?.type)&&("Tab"!=e.code||Lt||(r+=1,r>=lt.length&&(r=0),zt(`⌨️ tab to keyboard ${r}`),gt.set(r),e.preventDefault()))}async function Ft(e){zt(`👇 ${e.code}`);let{mode:t,modes:n,keys:o,keyboardIdx:r,activeElement:i,number:c,board:l,char:s}=Mt(e);if("Tab"==e.code&&e.preventDefault(),-1!=Qe.indexOf(i.type))zt(`🔡 using ${Qe.join(", ")}`),"Escape"==e.code&&(zt(`🚪 blurring ${i.type}`),i.blur()),o.Tab&&(c>=0&&c<lt.length?(zt(`⌨️ tabbed keyboard to index ${c}`),r=c,gt.set(r),Lt=!0):Lt=!1,e.preventDefault());else if(c>=0&&c<n.length)zt(`🛠 tabbed mode to index ${c}`),t=n[c],xt.set(t);else if("Escape"==e.code)Dt.ACTIVE=null;else if("KeyC"==e.code&&o.MetaLeft&&Dt.ACTIVE){const{start:e,end:t}=Dt.ACTIVE;console.log("[Keys] copying from",e,t);let n="";for(let o=e.y;o<=t.y;o++){for(let r=e.x;r<=t.x;r++)n+=Dt.OUT?.[o]?.[r]||Ye;o!=t.y&&(n+="\n")}if(n=n.replaceAll(Ye," "),!navigator.clipboard)return alert("no clipboard api!");await navigator.clipboard.writeText(n),console.log("[Keys] text copied\n",n)}else if(-1!=Kt.indexOf(e.code)&&Dt.ACTIVE){console.log(`[Keys] move ${e.code}`);const t=o.ShiftLeft?4:1;"ArrowLeft"==e.code?(Dt.ACTIVE.start.x-=t,Dt.ACTIVE.end.x-=t):"ArrowRight"==e.code?(Dt.ACTIVE.start.x+=t,Dt.ACTIVE.end.x+=t):"ArrowUp"==e.code?(Dt.ACTIVE.start.y-=t,Dt.ACTIVE.end.y-=t):"ArrowDown"==e.code&&(Dt.ACTIVE.start.y+=t,Dt.ACTIVE.end.y+=t)}else if(-1!=tt.indexOf(e.code)&&Dt.MODE==Ge&&Dt.ACTIVE?.type==Ge){console.log(`[Keys] fill chars with ${e.code}`,Dt.ACTIVE);const{start:t,end:n}=Dt.ACTIVE;for(let e=t.y;e<=n.y;e++)for(let o=t.x;o<=n.x;o++)Dt.ACTIVE.inputs[e]||(Dt.ACTIVE.inputs[e]={}),Dt.ACTIVE.inputs[e][o]=s}else if("Backspace"==e.key&&Dt.ACTIVE){console.log("[Keys] deleting layer");let e=Dt.DATA,t=Dt.DATA.indexOf(Dt.DATA.find((e=>e.ref==Dt.ACTIVE.ref)));if(-1==t)return console.log("[Keys] error finding index of selected");e.splice(t,1),Dt.DATA=e,Dt.ACTIVE=null}}const{window:_t}=R;function Pt(e,t,n){const o=e.slice();return o[16]=t[n],o[18]=n,o}function jt(e,t,n){const o=e.slice();return o[19]=t[n],o[21]=n,o}function Zt(e,t,n){const o=e.slice();return o[22]=t[n],o[24]=n,o}function Rt(e){let t,n,o,r,i,c,l=e[22]+"";function s(...t){return e[11](e[24],...t)}return{c(){t=h("div"),n=h("div"),o=g(l),r=y(),E(n,"class","flex bg row-center-center p0-5"),V(n,"filled",e[1]==e[24]),E(t,"class","pointer")},m(e,l){d(e,t,l),f(t,n),f(n,o),f(t,r),i||(c=x(n,"mousedown",s),i=!0)},p(t,o){e=t,2&o&&V(n,"filled",e[1]==e[24])},d(e){e&&p(t),i=!1,c()}}}function qt(e){let t,n,o,r,i,c,l,s,a=e[8](e[21],e[18])+"",u=e[9](e[21],e[18],e[1])+"";function m(...t){return e[12](e[21],e[18],...t)}return{c(){t=h("div"),n=h("span"),o=g(a),r=y(),i=h("span"),c=g(u),E(n,"class","pb0-4"),E(i,"class","f3"),E(t,"class","grow ptb0-5 pointer flex column-center-center br1-solid bb1-solid no-basis bg"),V(t,"fade",!e[2]),V(t,"filled",e[7](e[21],e[18],e[3],e[0],e[2]))},m(e,a){d(e,t,a),f(t,n),f(n,o),f(t,r),f(t,i),f(i,c),l||(s=x(t,"mousedown",m),l=!0)},p(n,o){e=n,2&o&&u!==(u=e[9](e[21],e[18],e[1])+"")&&w(c,u),4&o&&V(t,"fade",!e[2]),141&o&&V(t,"filled",e[7](e[21],e[18],e[3],e[0],e[2]))},d(e){e&&p(t),l=!1,s()}}}function Gt(e){let t,n,o,r=new Array(e[16]),i=[];for(let t=0;t<r.length;t+=1)i[t]=qt(jt(e,r,t));let c=10==e[16]&&function(e){let t,n,o;return{c(){t=h("span"),n=y(),o=h("span"),E(t,"class","grow"),E(o,"class","grow")},m(e,r){d(e,t,r),d(e,n,r),d(e,o,r)},d(e){e&&p(t),e&&p(n),e&&p(o)}}}();return{c(){t=h("div");for(let e=0;e<i.length;e+=1)i[e].c();n=y(),c&&c.c(),o=y(),E(t,"class","flex row")},m(e,r){d(e,t,r);for(let e=0;e<i.length;e+=1)i[e].m(t,null);f(t,n),c&&c.m(t,null),f(t,o)},p(e,o){if(975&o){let c;for(r=new Array(e[16]),c=0;c<r.length;c+=1){const l=jt(e,r,c);i[c]?i[c].p(l,o):(i[c]=qt(l),i[c].c(),i[c].m(t,n))}for(;c<i.length;c+=1)i[c].d(1);i.length=r.length}},d(e){e&&p(t),m(i,e),c&&c.d()}}}function Yt(t){let n,o,r,i,c,l,s=st,a=[];for(let e=0;e<s.length;e+=1)a[e]=Rt(Zt(t,s,e));let u=t[4],g=[];for(let e=0;e<u.length;e+=1)g[e]=Gt(Pt(t,u,e));return{c(){n=h("div"),o=h("div");for(let e=0;e<a.length;e+=1)a[e].c();r=y(),i=h("div");for(let e=0;e<g.length;e+=1)g[e].c();E(o,"class","flex row"),E(i,"id","keyboard"),E(i,"class","flex column w100pc bl1-solid bt1-solid"),V(i,"fade",!t[2]),E(n,"class","flex column w100pc")},m(e,s){d(e,n,s),f(n,o);for(let e=0;e<a.length;e+=1)a[e].m(o,null);f(n,r),f(n,i);for(let e=0;e<g.length;e+=1)g[e].m(i,null);c||(l=x(_t,"mouseup",t[10]),c=!0)},p(e,[t]){if(34&t){let n;for(s=st,n=0;n<s.length;n+=1){const r=Zt(e,s,n);a[n]?a[n].p(r,t):(a[n]=Rt(r),a[n].c(),a[n].m(o,null))}for(;n<a.length;n+=1)a[n].d(1);a.length=s.length}if(991&t){let n;for(u=e[4],n=0;n<u.length;n+=1){const o=Pt(e,u,n);g[n]?g[n].p(o,t):(g[n]=Gt(o),g[n].c(),g[n].m(i,null))}for(;n<g.length;n+=1)g[n].d(1);g.length=u.length}4&t&&V(i,"fade",!e[2])},i:e,o:e,d(e){e&&p(n),m(a,e),m(g,e),c=!1,l()}}}function Ut(e,t,n){let o,r,i,c;s(e,gt,(e=>n(1,o=e))),s(e,vt,(e=>n(13,r=e))),s(e,yt,(e=>n(2,i=e))),s(e,ht,(e=>n(3,c=e)));const l=window;function a(e){u(vt,r=document.activeElement,r),u(yt,i=-1!=Qe.indexOf(r?.type)||l.MODE==Ge,i)}function f(e){u(gt,o=e,o)}document.addEventListener("focus",a,!0),document.addEventListener("blur",a,!0);let d=null;function p(e,t){n(0,d=e+12*t)}return[d,o,i,c,[12,12,10],f,p,function(e,t,n,o,r){const i=e+12*t;return n[it[i]]&&r||o==i},function(e,t){return ct[e+12*t].toLowerCase()},function(e,t,n){return lt[n]?.[e+12*t]||""},e=>n(0,d=null),(e,t)=>f(e),(e,t,n)=>p(e,t)]}class Xt extends J{constructor(e){super(),X(this,e,Ut,Yt,i,{})}}const{window:Jt}=R;function Wt(e,t,n){const o=e.slice();return o[47]=t[n],o[49]=n,o}function Qt(e,t,n){const o=e.slice();return o[50]=t[n],o[49]=n,o}function en(e,t,n){const o=e.slice();return o[52]=t[n],o}function tn(e,t,n){const o=e.slice();return o[52]=t[n],o}function nn(e,t,n){const o=e.slice();return o[57]=t[n],o[59]=n,o}function on(e,t,n){const o=e.slice();return o[60]=t[n],o[62]=n,o}function rn(e){let t,n,r,i=(e[60]||Ye)+"";function c(...t){return e[17](e[59],e[62],...t)}function l(...t){return e[18](e[59],e[62],...t)}function s(...t){return e[19](e[59],e[62],...t)}function a(...t){return e[20](e[59],e[62],...t)}return{c(){t=h("span"),E(t,"style",e[2]),E(t,"class","char rel"),V(t,"active",e[60]),V(t,"inactive",!e[60]),V(t,"b1-solid",e[0].HOVER?.y==e[59]&&e[0].HOVER?.x==e[62]),V(t,"filled",e[0].HIGH?.[e[59]]?.[e[62]])},m(e,o){d(e,t,o),t.innerHTML=i,n||(r=[x(t,"mousemove",c),x(t,"mouseup",l),x(t,"mousedown",s),x(t,"mouseover",a)],n=!0)},p(n,o){e=n,1&o[0]&&i!==(i=(e[60]||Ye)+"")&&(t.innerHTML=i),4&o[0]&&E(t,"style",e[2]),1&o[0]&&V(t,"active",e[60]),1&o[0]&&V(t,"inactive",!e[60]),1&o[0]&&V(t,"b1-solid",e[0].HOVER?.y==e[59]&&e[0].HOVER?.x==e[62]),1&o[0]&&V(t,"filled",e[0].HIGH?.[e[59]]?.[e[62]])},d(e){e&&p(t),n=!1,o(r)}}}function cn(e){let t,n,o=e[57],r=[];for(let t=0;t<o.length;t+=1)r[t]=rn(on(e,o,t));return{c(){t=h("div");for(let e=0;e<r.length;e+=1)r[e].c();n=y(),E(t,"class","no-grow")},m(e,o){d(e,t,o);for(let e=0;e<r.length;e+=1)r[e].m(t,null);f(t,n)},p(e,i){if(229&i[0]){let c;for(o=e[57],c=0;c<o.length;c+=1){const l=on(e,o,c);r[c]?r[c].p(l,i):(r[c]=rn(l),r[c].c(),r[c].m(t,n))}for(;c<r.length;c+=1)r[c].d(1);r.length=o.length}},d(e){e&&p(t),m(r,e)}}}function ln(e){let t,n,r,i,c,l,s,a,u,f,m,g,v;return{c(){t=h("span"),t.textContent="fontsize",n=y(),r=h("input"),i=y(),c=h("span"),c.textContent="width",l=y(),s=h("input"),a=y(),u=h("span"),u.textContent="height",f=y(),m=h("input"),E(r,"type","number"),E(s,"type","number"),E(m,"type","number")},m(o,p){d(o,t,p),d(o,n,p),d(o,r,p),T(r,e[0].FONTSIZE),d(o,i,p),d(o,c,p),d(o,l,p),d(o,s,p),T(s,e[0].width),d(o,a,p),d(o,u,p),d(o,f,p),d(o,m,p),T(m,e[0].height),g||(v=[x(r,"input",e[29]),x(s,"input",e[30]),x(m,"input",e[31])],g=!0)},p(e,t){1&t[0]&&A(r.value)!==e[0].FONTSIZE&&T(r,e[0].FONTSIZE),1&t[0]&&A(s.value)!==e[0].width&&T(s,e[0].width),1&t[0]&&A(m.value)!==e[0].height&&T(m,e[0].height)},d(e){e&&p(t),e&&p(n),e&&p(r),e&&p(i),e&&p(c),e&&p(l),e&&p(s),e&&p(a),e&&p(u),e&&p(f),e&&p(m),g=!1,o(v)}}}function sn(e){let t,n=e[0].ACTIVE.type==Ze&&an(e);return{c(){n&&n.c(),t=v()},m(e,o){n&&n.m(e,o),d(e,t,o)},p(e,o){e[0].ACTIVE.type==Ze?n?n.p(e,o):(n=an(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&p(t)}}}function an(e){let t,n,r,i,c,l,s,a,u,v,w,b,I,V,$,k,O,S,D,K,M,L,z,N,B,F,_=[Ue,Xe,Je,We],P=[];for(let t=0;t<4;t+=1)P[t]=un(tn(e,_,t));let j=[Ue,Xe,Je],Z=[];for(let t=0;t<3;t+=1)Z[t]=fn(en(e,j,t));return{c(){t=h("label"),t.textContent="fill",n=y(),r=h("input"),i=y(),c=h("label"),c.textContent="corner",l=y(),s=h("input"),a=y(),u=h("label"),u.textContent="sides",v=y(),w=h("input"),b=y(),I=h("label"),I.textContent="x",V=y(),$=h("select");for(let e=0;e<4;e+=1)P[e].c();k=y(),O=h("label"),O.textContent="y",S=y(),D=h("select");for(let e=0;e<3;e+=1)Z[e].c();K=y(),M=h("label"),L=h("input"),z=g("\n\t\t\t\t\t\t\twhitespace\n\t\t\t\t\t\t\t"),N=h("span"),E(r,"type","number"),E(s,"type","number"),E(w,"type","number"),void 0===e[0].ACTIVE.alignX&&H((()=>e[26].call($))),void 0===e[0].ACTIVE.alignY&&H((()=>e[27].call(D))),E(L,"type","checkbox"),E(M,"class","checkbox")},m(o,p){d(o,t,p),d(o,n,p),d(o,r,p),T(r,e[0].ACTIVE.fill),d(o,i,p),d(o,c,p),d(o,l,p),d(o,s,p),T(s,e[0].ACTIVE.corner),d(o,a,p),d(o,u,p),d(o,v,p),d(o,w,p),T(w,e[0].ACTIVE.sides),d(o,b,p),d(o,I,p),d(o,V,p),d(o,$,p);for(let e=0;e<4;e+=1)P[e].m($,null);C($,e[0].ACTIVE.alignX),d(o,k,p),d(o,O,p),d(o,S,p),d(o,D,p);for(let e=0;e<3;e+=1)Z[e].m(D,null);C(D,e[0].ACTIVE.alignY),d(o,K,p),d(o,M,p),f(M,L),L.checked=e[0].ACTIVE.whitespace,f(M,z),f(M,N),B||(F=[x(r,"change",e[8]),x(r,"input",e[23]),x(s,"change",e[8]),x(s,"input",e[24]),x(w,"change",e[8]),x(w,"input",e[25]),x($,"change",e[8]),x($,"change",e[26]),x(D,"change",e[8]),x(D,"change",e[27]),x(L,"change",e[8]),x(L,"change",e[28])],B=!0)},p(e,t){if(1&t[0]&&A(r.value)!==e[0].ACTIVE.fill&&T(r,e[0].ACTIVE.fill),1&t[0]&&A(s.value)!==e[0].ACTIVE.corner&&T(s,e[0].ACTIVE.corner),1&t[0]&&A(w.value)!==e[0].ACTIVE.sides&&T(w,e[0].ACTIVE.sides),0&t){let n;for(_=[Ue,Xe,Je,We],n=0;n<4;n+=1){const o=tn(e,_,n);P[n]?P[n].p(o,t):(P[n]=un(o),P[n].c(),P[n].m($,null))}for(;n<4;n+=1)P[n].d(1)}if(1&t[0]&&C($,e[0].ACTIVE.alignX),0&t){let n;for(j=[Ue,Xe,Je],n=0;n<3;n+=1){const o=en(e,j,n);Z[n]?Z[n].p(o,t):(Z[n]=fn(o),Z[n].c(),Z[n].m(D,null))}for(;n<3;n+=1)Z[n].d(1)}1&t[0]&&C(D,e[0].ACTIVE.alignY),1&t[0]&&(L.checked=e[0].ACTIVE.whitespace)},d(e){e&&p(t),e&&p(n),e&&p(r),e&&p(i),e&&p(c),e&&p(l),e&&p(s),e&&p(a),e&&p(u),e&&p(v),e&&p(w),e&&p(b),e&&p(I),e&&p(V),e&&p($),m(P,e),e&&p(k),e&&p(O),e&&p(S),e&&p(D),m(Z,e),e&&p(K),e&&p(M),B=!1,o(F)}}}function un(t){let n,o,r,i=t[52]+"";return{c(){n=h("option"),o=g(i),n.__value=r=t[52],n.value=n.__value},m(e,t){d(e,n,t),f(n,o)},p:e,d(e){e&&p(n)}}}function fn(t){let n,o,r,i=t[52]+"";return{c(){n=h("option"),o=g(i),n.__value=r=t[52],n.value=n.__value},m(e,t){d(e,n,t),f(n,o)},p:e,d(e){e&&p(n)}}}function dn(e){let t;function n(e,t){return e[0].ACTIVE?sn:ln}let o=n(e),r=o(e);return{c(){t=h("div"),r.c(),E(t,"class","flex column-stretch-flex-start p0-5")},m(e,n){d(e,t,n),r.m(t,null)},p(e,i){o===(o=n(e))&&r?r.p(e,i):(r.d(1),r=o(e),r&&(r.c(),r.m(t,null)))},d(e){e&&p(t),r.d()}}}function pn(e){let t,n,o,r,i,c,l,s,a=e[49]+1+"",u=e[50]+"";function m(...t){return e[32](e[50],...t)}return{c(){t=h("div"),n=g("["),o=g(a),r=g("] "),i=g(u),c=y(),E(t,"class","bb p0-5 text-left"),V(t,"filled",e[3]==e[50])},m(e,a){d(e,t,a),f(t,n),f(t,o),f(t,r),f(t,i),f(t,c),l||(s=x(t,"mousedown",m),l=!0)},p(n,o){e=n,8&o[0]&&V(t,"filled",e[3]==e[50])},d(e){e&&p(t),l=!1,s()}}}function mn(e){let t,n=Object.keys(et),o=[];for(let t=0;t<n.length;t+=1)o[t]=pn(Qt(e,n,t));return{c(){t=h("nav");for(let e=0;e<o.length;e+=1)o[e].c();E(t,"id","toolbar"),E(t,"class","column flex")},m(e,n){d(e,t,n);for(let e=0;e<o.length;e+=1)o[e].m(t,null)},p(e,r){if(8&r[0]){let i;for(n=Object.keys(et),i=0;i<n.length;i+=1){const c=Qt(e,n,i);o[i]?o[i].p(c,r):(o[i]=pn(c),o[i].c(),o[i].m(t,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}},d(e){e&&p(t),m(o,e)}}}function hn(e){let t,n;return t=new Xt({}),{c(){q(t.$$.fragment)},m(e,o){G(t,e,o),n=!0},i(e){n||(j(t.$$.fragment,e),n=!0)},o(e){Z(t.$$.fragment,e),n=!1},d(e){Y(t,e)}}}function gn(e){let t,n,o,r,i,c,l=e[47].type+"";function s(...t){return e[33](e[47],...t)}return{c(){t=h("div"),n=h("header"),o=h("div"),r=g(l),E(n,"class","pointer p0-5 w100pc flex row-space-between-center"),V(n,"filled",e[47]?.ref==e[0].ACTIVE?.ref),E(t,"class","bb1-solid w100pc flex column")},m(e,l){d(e,t,l),f(t,n),f(n,o),f(o,r),i||(c=x(t,"click",s),i=!0)},p(t,o){e=t,1&o[0]&&l!==(l=e[47].type+"")&&w(r,l),1&o[0]&&V(n,"filled",e[47]?.ref==e[0].ACTIVE?.ref)},d(e){e&&p(t),i=!1,c()}}}function yn(e){let t,n=e[47].inited&&gn(e);return{c(){n&&n.c(),t=v()},m(e,o){n&&n.m(e,o),d(e,t,o)},p(e,o){e[47].inited?n?n.p(e,o):(n=gn(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&p(t)}}}function vn(e){let t;return{c(){t=h("div"),t.textContent="no layers",E(t,"class","grow w100pc flex row-center-center italic p0-5 fade")},m(e,n){d(e,t,n)},d(e){e&&p(t)}}}function xn(e){let t,n,o=e[0].DATA,r=[];for(let t=0;t<o.length;t+=1)r[t]=yn(Wt(e,o,t));let i=0==e[0].DATA.length&&vn();return{c(){t=h("div");for(let e=0;e<r.length;e+=1)r[e].c();n=y(),i&&i.c(),E(t,"id","layers"),E(t,"class","flex overflow-auto column grow")},m(e,o){d(e,t,o);for(let e=0;e<r.length;e+=1)r[e].m(t,null);f(t,n),i&&i.m(t,null)},p(e,c){if(17&c[0]){let i;for(o=e[0].DATA,i=0;i<o.length;i+=1){const l=Wt(e,o,i);r[i]?r[i].p(l,c):(r[i]=yn(l),r[i].c(),r[i].m(t,n))}for(;i<r.length;i+=1)r[i].d(1);r.length=o.length}0==e[0].DATA.length?i||(i=vn(),i.c(),i.m(t,null)):i&&(i.d(1),i=null)},d(e){e&&p(t),m(r,e),i&&i.d()}}}function En(t){let n;return{c(){n=h("div"),n.textContent="nothing selected",E(n,"class","grow w100pc flex row-center-center italic p0-5 fade")},m(e,t){d(e,n,t)},p:e,d(e){e&&p(n)}}}function An(e){let t,n,r;return{c(){t=h("textarea"),E(t,"class","flex grow w100pc h100pc grow b0-solid"),E(t,"rows","4")},m(o,i){d(o,t,i),T(t,e[0].ACTIVE.text),n||(r=[x(t,"keyup",Nt),x(t,"keydown",e[12]),x(t,"input",e[34])],n=!0)},p(e,n){1&n[0]&&T(t,e[0].ACTIVE.text)},d(e){e&&p(t),n=!1,o(r)}}}function wn(e){let t;function n(e,t){return e[0].ACTIVE?.type==Ze?An:En}let o=n(e),r=o(e);return{c(){t=h("div"),r.c(),E(t,"class","minh16em minw24em grow flex column")},m(e,n){d(e,t,n),r.m(t,null)},p(e,i){o===(o=n(e))&&r?r.p(e,i):(r.d(1),r=o(e),r&&(r.c(),r.m(t,null)))},d(e){e&&p(t),r.d()}}}function Tn(e){let t,n,r,i,c,l,s,a,u,g,v,A,w,T,b,C,I,V,$,k,O,S=e[0].OUT,D=[];for(let t=0;t<S.length;t+=1)D[t]=cn(nn(e,S,t));return u=new je({props:{title:"Properties",right:20,top:100,$$slots:{default:[dn]},$$scope:{ctx:e}}}),v=new je({props:{title:"Tools",left:20,top:50,$$slots:{default:[mn]},$$scope:{ctx:e}}}),w=new je({props:{title:"Input",left:20,bottom:20,$$slots:{default:[hn]},$$scope:{ctx:e}}}),b=new je({props:{title:"Layers",right:20,top:50,$$slots:{default:[xn]},$$scope:{ctx:e}}}),I=new je({props:{title:"Text",right:20,bottom:20,$$slots:{default:[wn]},$$scope:{ctx:e}}}),{c(){t=h("input"),n=y(),r=h("main"),i=h("div"),c=y(),l=h("div"),s=h("div");for(let e=0;e<D.length;e+=1)D[e].c();a=y(),q(u.$$.fragment),g=y(),q(v.$$.fragment),A=y(),q(w.$$.fragment),T=y(),q(b.$$.fragment),C=y(),q(I.$$.fragment),E(t,"type","text"),E(t,"id","capture"),E(t,"class","invisible hidden fixed"),E(i,"class","dragger fill"),E(s,"id","canvas"),E(s,"class","flex column-center-flex-start rel monospace user-select-none bg overflow-auto pop"),E(l,"id","zoom"),E(l,"class","fill flex column-center-center"),E(r,"class",V="sassis sink fill monospace overflow-hidden b10-solid "+e[0].mousecursor)},m(o,p){d(o,t,p),d(o,n,p),d(o,r,p),f(r,i),f(r,c),f(r,l),f(l,s);for(let e=0;e<D.length;e+=1)D[e].m(s,null);e[21](s),e[22](l),f(r,a),G(u,r,null),f(r,g),G(v,r,null),f(r,A),G(w,r,null),f(r,T),G(b,r,null),f(r,C),G(I,r,null),$=!0,k||(O=[x(Jt,"keydown",e[9]),x(Jt,"keyup",e[10]),x(Jt,"mousemove",e[13]),x(Jt,"mouseup",e[16]),x(i,"mousedown",e[11])],k=!0)},p(e,t){if(229&t[0]){let n;for(S=e[0].OUT,n=0;n<S.length;n+=1){const o=nn(e,S,n);D[n]?D[n].p(o,t):(D[n]=cn(o),D[n].c(),D[n].m(s,null))}for(;n<D.length;n+=1)D[n].d(1);D.length=S.length}const n={};1&t[0]|2&t[2]&&(n.$$scope={dirty:t,ctx:e}),u.$set(n);const o={};8&t[0]|2&t[2]&&(o.$$scope={dirty:t,ctx:e}),v.$set(o);const i={};2&t[2]&&(i.$$scope={dirty:t,ctx:e}),w.$set(i);const c={};1&t[0]|2&t[2]&&(c.$$scope={dirty:t,ctx:e}),b.$set(c);const l={};1&t[0]|2&t[2]&&(l.$$scope={dirty:t,ctx:e}),I.$set(l),(!$||1&t[0]&&V!==(V="sassis sink fill monospace overflow-hidden b10-solid "+e[0].mousecursor))&&E(r,"class",V)},i(e){$||(j(u.$$.fragment,e),j(v.$$.fragment,e),j(w.$$.fragment,e),j(b.$$.fragment,e),j(I.$$.fragment,e),$=!0)},o(e){Z(u.$$.fragment,e),Z(v.$$.fragment,e),Z(w.$$.fragment,e),Z(b.$$.fragment,e),Z(I.$$.fragment,e),$=!1},d(i){i&&p(t),i&&p(n),i&&p(r),m(D,i),e[21](null),e[22](null),Y(u),Y(v),Y(w),Y(b),Y(I),k=!1,o(O)}}}function bn(){return{date:new Date}}function Cn(e,t,n){let o,r,i;s(e,ht,(e=>n(41,r=e))),s(e,xt,(e=>n(3,i=e)));let c={},l={start:{},end:{}};const a=e=>console.log(`[App] ${e}`),f=window;function d(e){const{start:t,end:o}=e;console.log("[App] set selected:",t,o),e&&(n(0,f.ACTIVE=e,f),n(0,f.ACTIVE.origin={...l.start},f),n(0,f.ACTIVE.startOrigin={...e.start},f),n(0,f.ACTIVE.endOrigin={...e.end},f)),T()}f.zoomEl=null,f.canvasEl=null,f.zoomTransform={},f.DATA=[],f.OUT=[],f.FONTSIZE=13,f.HOVER=null,f.HIGH=[],f.ACTIVE=null,f.width=80,f.height=32,f.KEYCODES={};let p=!1,m=!1;function h(e,t){if(n(1,c.pressed=!0,c),n(0,f.ACTIVE=!1,f),l.start={y:e,x:t},l.end={y:e,x:t},i==Ze)a(" create rect"),n(1,c.rectangle=!0,c),n(0,f.ACTIVE={type:Ze,ref:bn(),chars:[],...l,text:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi id sagittis orci, non rhoncus velit. Nam sed tellus cursus, interdum nulla ac, iaculis libero. Nam ullamcorper nulla sem, id gravida dui posuere vitae. Morbi finibus ultrices ligula id varius. Ut lobortis ornare nisl in efficitur. Mauris viverra est malesuada, feugiat tellus in, faucibus risus. Vivamus sed lacinia diam. Cras in ullamcorper lacus, ac euismod ex.".substring(0,10),fill:17,corner:0,sides:0,padding:2,inited:!1,alignX:Ue,alignY:Xe},f),n(0,f.DATA=[f.ACTIVE,...f.DATA],f);else if(i==Ge)a(" create chars"),n(1,c.char=!0,c),n(0,f.ACTIVE={type:Ge,ref:bn(),chars:[],...l,origin:{...l.start},inputs:{},inited:!1},f),n(0,f.DATA=[f.ACTIVE,...f.DATA],f);else if(i==qe)a(" create select"),n(1,c.select=!0,c),n(0,f.ACTIVE={type:qe,ref:bn(),...l,inited:!1},f),T();else if(i==Re){a(" create pointer");let o=C(e,t);if(!o)return n(0,f.HIGH=[],f),T(),a(" no item clicked");e==o.end.y&&t==o.end.x?m=!0:p=!0,console.log("[App] selected layer:",o),n(0,f.ACTIVE=o,f),n(0,f.ACTIVE.origin={...l.start},f),n(0,f.ACTIVE.startOrigin={...f.ACTIVE.start},f),n(0,f.ACTIVE.endOrigin={...f.ACTIVE.end},f),ft(),dt(),T()}}let g,y,v={};function x(e,t){if(!c.pressed)return;if(v.x==t&&v.y==e)return;v=l.end={y:e,x:t};let o={...l.start},r={...l.end};if(l.start.x>l.end.x&&(o.x=l.end.x,r.x=l.start.x),l.start.y>l.end.y&&(o.y=l.end.y,r.y=l.start.y),p&&f.ACTIVE){console.log("[App] drag move");const{origin:o,startOrigin:r,endOrigin:i,type:c}=f.ACTIVE;n(0,f.ACTIVE.start.x=r.x+(t-o.x),f),n(0,f.ACTIVE.end.x=i.x+(t-o.x),f),n(0,f.ACTIVE.start.y=r.y+(e-o.y),f),n(0,f.ACTIVE.end.y=i.y+(e-o.y),f),n(0,f.HIGH=[],f),T()}else if(m&&f.ACTIVE){console.log("[App] drag resizing");const{origin:o,startOrigin:r,endOrigin:i,type:c}=f.ACTIVE;n(0,f.ACTIVE.end.x=i.x+(t-o.x),f),n(0,f.ACTIVE.end.y=i.y+(e-o.y),f),n(0,f.HIGH=[],f),T()}else c.rectangle?(console.log("[App] drag rectangle"),n(0,f.ACTIVE.start=o,f),n(0,f.ACTIVE.end=r,f),T()):c.select?(console.log("[App] drag select"),n(0,f.ACTIVE.start=o,f),n(0,f.ACTIVE.end=r,f),T()):c.char&&(console.log("[App] drag chars"),n(0,f.ACTIVE.start=o,f),n(0,f.ACTIVE.end=r,f),T())}function E(e,t){if(n(1,c.pressed=!1,c),c.select&&(n(1,c.select=!1,c),n(0,f.ACTIVE.start=l.start,f),n(0,f.ACTIVE.end={y:e,x:t},f)),c.rectangle&&n(1,c.rectangle=!1,c),c.char&&n(1,c.char=!1,c),m=!1,p=!1,f.ACTIVE?.type==Ze)if(f.ACTIVE.start.x==f.ACTIVE.end.x||f.ACTIVE.start.y==f.ACTIVE.end.y){a(" deleting tiny rectangle");let o=f.DATA;o.shift(),n(0,f.DATA=o,f);let r=C(e,t);r&&i==r?.type&&(console.log("[App] selected with same tool type:",r),n(0,f.ACTIVE=r,f))}else f.DATA[0],a(" inited new rectangle:"),n(0,f.DATA[0].inited=!0,f);T()}function w(){f.requestAnimationFrame(T)}function T(){a("🌱 drawn"),ft(),dt(),function(){if(!at.ACTIVE||at?.ACTIVE?.type!=Ge)return;ut("🅰️ set");let{start:e,end:t,inputs:n}=at.ACTIVE;t.x,e.x,t.y,e.y;const{x:o,y:r}=at.ACTIVE.origin;console.log(`[App] setting chars from origin ${o}/${r}`);for(let e=0;e<=at.height;e++)for(let t=0;t<=at.width;t++)at.ACTIVE.chars[e]||(at.ACTIVE.chars[e]=[]),at.ACTIVE.chars[e][t]=n?.[e]?.[t]||null}(),n(0,f.HIGH=[],f);const{start:e,end:t}=f.ACTIVE||{};f.ACTIVE&&(f.ACTIVE.type==Ze||f.ACTIVE.type);for(let o=0;o<f.height;o++)for(let r=0;r<f.width;r++){f.OUT[o]||n(0,f.OUT[o]=[],f);const i=b(o,r);f.OUT[o][r]==i&&null!=f.OUT[o][r]||n(0,f.OUT[o][r]=i,f);const c=r>=e?.x&&r<=t?.x,l=o>=e?.y&&o<=t?.y;f.HIGH[o]||n(0,f.HIGH[o]=[],f),n(0,f.HIGH[o][r]=c&&l,f)}f.DB_TIMEOUT&&clearTimeout(f.DB_TIMEOUT),n(0,f.DB_TIMEOUT=setTimeout((e=>{f.localStorage.setItem("DB",JSON.stringify(f.DATA)),a("💾 saved")}),1e3),f)}function b(e,t){for(let n of f.DATA)if(n?.chars?.[e]?.[t])return n.chars[e][t];return null}function C(e,t){for(let n of f.DATA)if(n?.chars?.[e]?.[t])return n;return null}f.DB_TIMEOUT=null,O((async e=>{try{a("💾 loading..."),n(0,f.DATA=JSON.parse(f.localStorage.getItem("DB"))||[],f),await w(),a("💾 loaded")}catch(e){console.warn("💾 nothing loaded")}n(0,f.zoomer=Ke(f.zoomEl,{maxZoom:20,minZoom:.02,zoomDoubleClickSpeed:1,filterKey:e=>!0,beforeMouseDown:e=>e.target.classList.contains("char")}),f),f.zoomer.on("transform",(e=>{n(0,f.zoomTransform=f.zoomer.getTransform(),f)})),f.zoomer.on("pan",(e=>{n(0,f.isPanning=!0,f)})),f.zoomer.on("panend",(e=>{n(0,f.isPanning=!1,f)}))}));let V=[];f.mousecursor="",f.isPanning=!1;return e.$$.update=()=>{49153&e.$$.dirty[0]&&((e,t)=>{e==g&&t==y||(T(),n(14,g=e),n(15,y=t))})(f.width,f.height),1&e.$$.dirty[0]&&n(2,o=`\n\t\tfont-size: ${f.FONTSIZE}px;\n\t\tline-height: 1em;\n\t\twidth: ${Math.round(.6*f.FONTSIZE)}px;\n\t\tmax-width: ${Math.round(.6*f.FONTSIZE)}px;\n\t\tmin-width: ${Math.round(.6*f.FONTSIZE)}px;\n\t`),1&e.$$.dirty[0]&&f.ACTIVE&&(f.ACTIVE?.start?.x,f.ACTIVE?.start?.y,f.ACTIVE?.end?.x,f.ACTIVE?.start?.x,f.ACTIVE?.end?.y,f.ACTIVE?.start?.y)},[f,c,o,i,d,h,x,E,w,e=>{u(ht,r[e.code]=!0,r),e.metaKey&&V.push(e.code),Ft(e),T()},e=>{if(u(ht,r[e.code]=!1,r),V.length>0){for(const e of V)u(ht,r[e]=!1,r);V=[]}Bt(e),T()},function(){console.log("?"),n(0,f.ACTIVE=null,f),n(0,f.HIGH=[],f),T()},function(e){Ht(e),w()},function(e){const{classList:t}=e.target;f.isPanning||(t.contains("active")?n(0,f.mousecursor="pointer",f):(t.contains("dragger"),n(0,f.mousecursor="",f)))},g,y,e=>n(1,c.pressed=!1,c),(e,t,n)=>x(e,t),(e,t,n)=>E(e,t),(e,t,n)=>h(e,t),(e,t,n)=>{},function(e){D[e?"unshift":"push"]((()=>{f.canvasEl=e,n(0,f)}))},function(e){D[e?"unshift":"push"]((()=>{f.zoomEl=e,n(0,f)}))},function(){f.ACTIVE.fill=A(this.value),n(0,f)},function(){f.ACTIVE.corner=A(this.value),n(0,f)},function(){f.ACTIVE.sides=A(this.value),n(0,f)},function(){f.ACTIVE.alignX=I(this),n(0,f)},function(){f.ACTIVE.alignY=I(this),n(0,f)},function(){f.ACTIVE.whitespace=this.checked,n(0,f)},function(){f.FONTSIZE=A(this.value),n(0,f)},function(){f.width=A(this.value),n(0,f)},function(){f.height=A(this.value),n(0,f)},(e,t)=>u(xt,i=e,i),(e,t)=>d(e),function(){f.ACTIVE.text=this.value,n(0,f)}]}return new class extends J{constructor(e){super(),X(this,e,Cn,Tn,i,{},null,[-1,-1,-1])}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
